# PDBFieldLister

## Overview

**PDBFieldLister** is a command-line tool that extracts and prints the field layout of a specified C/C++ struct from a Microsoft Program Database (PDB) file. It outputs the structure in a CSV format to standard output, including nested structures, field offsets, byte sizes, array dimensions, and type names.

This tool uses the **Microsoft Debug Interface Access (DIA) SDK**, which enables introspection of compiled binaries.

---

## What is a PDB File?

A `.pdb` (Program Database) file is a debugging file generated by the Microsoft Visual Studio compiler. It contains symbols, type information, function definitions, and variable layout data needed for debugging and analysis tools. **PDBFieldLister** relies on this file to reverse-engineer and list the memory layout of structs defined in C/C++ source code.

---

## Features

- Parses top-level and nested struct fields
- Outputs CSV data: `structName, offset, byteSize, array1length, array2length, classname`
- Handles arrays and nested user-defined types (UDTs)
- Clean and structured output suitable for parsing in MATLAB, Python, etc.

---

## Requirements

- Windows OS
- Visual Studio 2017 or later
- DIA SDK (typically installed with Visual Studio)
- PDB file compiled with `/Zi` and `/DEBUG` options
- Register the correct version of `msdia*.dll` before first use

---

## Registering the DIA Library

Locate and register `msdia140.dll` (or the version that matches your Visual Studio installation).

**Command (run in elevated Command Prompt):**

```cmd
regsvr32 "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\DIA SDK\bin\amd64\msdia140.dll"
```

> Replace the path with the actual location of your DIA SDK DLL.

---

## Building

1. Open `PDBFieldLister.sln` in Visual Studio 2019 or later.
2. Select `x64` as the build platform (recommended for DIA compatibility).
3. Ensure your project is compiled with `/Zi` and `/DEBUG` flags so a `.pdb` file is generated.
4. Build the project to produce `PDBFieldLister.exe`.

---

## Usage

```cmd
PDBFieldLister.exe <path-to-pdb-file> <struct-name>
```

**Example:**

```cmd
PDBFieldLister.exe ./Debug/MyApp.pdb MainStruct
```

---

## Sample Output

```
MainStruct_field1,0,4,1,1,int
MainStruct_field2,4,8,1,1,double
MainStruct_subStruct_fieldX,12,4,1,1,float
MainStruct_arrayField,16,40,10,1,float
```

Each row represents:
- Fully qualified field name
- Offset in bytes from the start of the struct
- Byte size of the field
- Array dimensions (if any)
- Field's base class/type name

---

## License

This project is released under a permissive license. You are free to use, modify, and distribute the source code and binary. No warranties are provided.

---

## Acknowledgements

- Microsoft DIA SDK for symbol access
- Visual Studio for PDB generation